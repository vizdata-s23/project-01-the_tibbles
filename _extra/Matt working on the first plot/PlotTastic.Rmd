```{r org-chunk,message=FALSE,warning=FALSE}
#suppressWarnings(library(tidyverse))
#install.packages("usmap")
#install.packages("mapdata")
library(knitr)
library(viridis)
library(tidyverse)
library(dplyr)
library(maps)
library(mapdata)
setwd("~/DataVizClass/project-1-the_tibbles")
bigfoot <- readr::read_csv('data/bigfoot.csv')
```

```{r question-1-figure-1-plot-1 ,fig.align="center", echo = FALSE,fig.width=15, fig.height=12}
bigfoot_xy <- bigfoot %>% select(latitude,
                                 longitude,
                                 date)
bigfoot_xy <- bigfoot_xy %>% filter(!is.na(latitude) & 
                                      !is.na(longitude) & 
                                      !is.na(date))
bigfoot_xy <- bigfoot_xy %>% mutate(date = as.integer(substring(date,
                                                                1,
                                                                4)))
usa <- map_data('usa')
state <- map_data('state')
bigfoot_xy <- bigfoot_xy %>% 
  mutate(alt_date = as.integer(substring(date,1,3))*10)
bigfoot_xy <- bigfoot_xy %>% 
  mutate(decade = paste(substring(date,1,3),"0s",
                        sep = ""))
bigfoot_xy <- bigfoot_xy %>% 
  mutate(decade=ifelse(date<1970,
                       "Pre-1970",
                       decade))
bigfoot_xy <- bigfoot_xy %>% 
  mutate(decade=ifelse(date>2009,
                       "Post-2010",
                       decade))
bigfoot_xy <- bigfoot_xy %>% 
  mutate(decade=factor(decade,
                       levels=c("Pre-1970",
                                "1970s",
                                "1980s",
                                "1990s",
                                "2000s",
                                "Post-2010")))

bigfoot_xy_mL <- bigfoot_xy %>% filter(longitude > - 125 & 
                                         longitude < -65 & 
                                         latitude > 25 & 
                                         latitude < 50)
bigfoot_xy_mL_B <- bigfoot_xy_mL %>% 
  group_by(decade) %>% 
  summarise(longitude = median(longitude),
            latitude=median(latitude))

ggplot()+
  geom_polygon(data=state,aes(x=long,y=lat,group=group),color="black",fill=NA,alpha=1)+
    geom_polygon(data=usa,aes(x=long,y=lat,group=group),color="black",fill="white",alpha=0.75)+
  geom_point(data=bigfoot_xy,
             mapping=aes(x=longitude,y=latitude),
             shape=18,
             color="darkgreen",
             alpha=0.25)+
    geom_point(data = bigfoot_xy_mL_B, 
               mapping=aes(x=longitude,
                           y=latitude),
               shape=18,
               color="gold2",
               size=3)+
  coord_fixed(ratio=1.3,
              xlim=c(-125,-65),
              ylim=c(25,50))+
    facet_wrap(~  decade,
               ncol=2)+
  xlab("Longitude (°W)")+
  ylab("Latitude (°N)")+
  labs(title="Bigfoot Sightings in the Mainland United States, 1869-present",
       subtitle=("Median sighting position in yellow"),
       axis.title=element_text(size=15),
        plot.title=element_text(size=25))
  
```

