---
title: "Statsquatch: An Expedition into Bigfoot Sightings Data"
subtitle: "STA/ISS 313 - Project 1"
author: "The Tibbles"
format: html
editor: visual
---

## Abstract

Abstract Goes Here

[***!!!!! NOT COMPLETE !!!!!***]{.underline}

------------------------------------------------------------------------

## Introduction

The Tibbles choose the Bigfoot dataset from TidyTuesday. The data originates from a publicly available database on the Bigfoot Field Researchers Organization (BFRO) website, and the dataset created by Timothy Renner first became available on Data World in 2017. The dataset contains 5,021 rows, with each row representing a separate Bigfoot sighting, and 28 columns, with each column providing details on the sighting. The columns can generally be categorized as lengthier descriptions of the sighting observations, time and geographic details, and weather details.

The Tibbles opted to work with this dataset because of our shared predilection for the supernatural and the potential this information holds to prove once and for all the existence (or lack thereof) of one of the most iconic creatures in the North American imagination. It contains a wealth of observations with plenty of categorical and numerical data well-suited for comprehensive analysis and interpretation.

[***!!!!! NOT REWRITTEN -- REMOVE THIS AFTER REVIEWING BEFORE FINAL TURN-IN !!!!!***]{.underline}

## Question 1: Change in Geographic Distribution of Bigfoot Sightings over Time

### Introduction

The first question looks at the geographic distribution of Bigfoot sightings, and how these observations changes over the decades. We use the latitude, longitude, and date variables to determine the precise location and decade the observation occurred.

The Tibbles are interested in this because investigating changes in the geographic distribution of Bigfoot sightings over time could provide insights into patterns of human perception and belief in paranormal phenomena, as well as the impact of media and popular culture on these beliefs. Understanding these changes in the geographic distribution of sightings over time could also shed new light on this elusive creature.

[***!!!!! NOT COMPLETE !!!!!***]{.underline}

### Approach

We made four plots. The first two directly plot the geographic distribution of Bigfoot on the mainland United States. One is a simple scatterplot, essentially an explicit map of sightings, which allows us to directly observe clusters of sightings as well as areas of relative absence- for example, the surge of sightings in the mountains of California during the 2000s. The second is a heatmap, which trades the precision of directly mapping all sightings for the advantage of clearly showing density. In Washington State, for example, Bigfoot sightings are quite common, and they overlap when plotted one-by-one. The heatmap aggregates these sightings into a common grid space which lights up brightly, easily identifying the hotspot. Both the scatterplot and the heatmap were faceted by decade so that we could make comparisons across time.

The other pair of plots we used were stacked bar graphs, which track the proportion of Bigfoot sightings by decade that were contributed by each region of the country. As outlined in our proposal, we thought first about using states for this task, but 50 unique colors would make for a hideous result, so we aggregated the states by their U.S. Census division and region, trading precision for clarity. We then faceted, again, by decade, which enables us to track fluctuations in those proportions over time. We chose to use a stacked bar plot in the interest of concision- although it is slightly more difficult to determine the precise proportion of a region for a given decade, the density of data is much greater than for a conventional bar plot that might display the regions in separate columns. Lastly, we chose to graph proportions and not nominal counts, because the focus of our research question is not the quantity of sightings, but rather the overall changes in the distribution as a whole. Additionally, since some decades produced dramatically more sightings (in our dataset) than others, it may have been near impossible to clearly observe trends in the less-populated decades of our data.

[***!!!!! NOT COMPLETE !!!!! REWRITE AND REMOVE THIS BEFORE TURNING IN***]{.underline}

### Analysis

```{r question-1-setup, warning=FALSE, message=FALSE}
#install.packages("usmap")
#install.packages("mapdata")
library(knitr)
library(viridis)
library(tidyverse)
library(dplyr)
library(maps)
library(stringr)
library(mapdata)
bigfoot <- readr::read_csv('data/bigfoot.csv')
census <- readr::read_csv('data/CensusDivisions.csv')
bigfoot_xy <- bigfoot |> 
  select(latitude,
         longitude,
         date)
bigfoot_xy <- bigfoot_xy |> 
  filter(!is.na(latitude) & 
           !is.na(longitude) &
           !is.na(date))
bigfoot_xy <- bigfoot_xy |> 
  mutate(date = as.integer(substring(date,1,4)))
usa <- map_data('usa')
state <- map_data('state')
bigfoot_xy <- bigfoot_xy |> 
  mutate(alt_date = as.integer(substring(date,1,3))*10)
bigfoot_xy <- bigfoot_xy |> 
  mutate(decade = paste(substring(date,1,3),"0s",
                        sep = ""))
bigfoot_xy <- bigfoot_xy |> 
  mutate(decade=ifelse(date<1970,
                       "Pre-1970",
                       decade))
bigfoot_xy <- bigfoot_xy |> 
  mutate(decade=ifelse(date>2009,
                       "Post-2010",
                       decade))
bigfoot_xy <- bigfoot_xy |> 
  mutate(decade=factor(decade,
                       levels=c("Pre-1970",
                                "1970s",
                                "1980s",
                                "1990s",
                                "2000s",
                                "Post-2010")))

bigfoot_xy_mL <- bigfoot_xy |> filter(longitude > - 125 & 
                                         longitude < -65 & 
                                         latitude > 25 & 
                                         latitude < 50)
bigfoot_xy_mL_B <- bigfoot_xy_mL |> 
  group_by(decade) |> 
  summarise(longitude = median(longitude),
            latitude=median(latitude))
bigfoot_xy_mL_B <- bigfoot_xy_mL_B |>
  mutate(colour_dummy = "Median")
bigfoot_xy <- bigfoot_xy %>%
  mutate(colour_dummy = "Sighting")
```

```{r question-1-figures-1, fig.align="center", warning=FALSE, message=FALSE,fig.width=15, fig.height=12, fig.show='hold'}
cols <- c("Sighting" = "darkgreen", 
          "Median" = "gold4")
ggplot()+
  geom_polygon(data=state, #State Boundary
               aes(x=long,
                   y=lat,
                   group=group),
               color="black",
               fill=NA,
               alpha=1)+
    geom_polygon(data=usa, #National Boundary
                 aes(x=long,
                     y=lat,
                     group=group),
                 color="black",
                 fill="white",
                 alpha=0.75)+
  geom_point(data=bigfoot_xy, #All Points
             mapping=aes(x=longitude,
                         y=latitude,
                         color=colour_dummy),
             shape=18,
             alpha=0.25)+
    geom_point(data = bigfoot_xy_mL_B, #Medians
               mapping=aes(x=longitude,
                           y=latitude,
                           color=colour_dummy),
               shape=18,
               size=5)+
  coord_fixed(ratio=1.3,
              xlim=c(-125,-65),
              ylim=c(25,50))+
    facet_wrap(~  decade,
               ncol=2)+
  labs(title="Bigfoot Sightings in the Mainland United States, 1869-present",
       axis.title=element_text(size=15),
        plot.title=element_text(size=25))+
  theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      plot.title=element_text(size=20),
      panel.background=element_rect(fill="#EBEBEB"),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      legend.text=element_text(size=15),
      strip.text.x=element_text(size=15))+
      scale_colour_manual(values = cols,
                          name = element_blank())
rec_box <- data.frame(x=c(-155,-155,-55.5,-55.5,-155), 
                      y=c(10,60,60,10,10))
outline <- map("usa", 
               plot=FALSE)
outline <- data.frame(x=outline$x,
                      y=outline$y)
mask <- rbind(rec_box,
              outline)

ggplot()+
  geom_polygon(data=usa, #State Background
               aes(x=long,
                   y=lat,
                   group=group),
               color=NA,
               fill="white",
               alpha=1,
               linewidth=1)+
  geom_bin2d(data=bigfoot_xy, #Heatmap
             mapping=aes(x=longitude,
                         y=latitude),
             alpha=1,
             binwidth = c(2, 2))+
  geom_polygon(data=state, #State Boundary
               aes(x=long,
                   y=lat,
                   group=group),
               color="black",
               fill=NA,
               alpha=0.5)+
  geom_polygon(data=mask, #National Mask
               aes(x=x,y=y),
               color="#EBEBEB",
               fill="#EBEBEB",
               alpha=1)+
  geom_polygon(data=usa, #National Boundary
               aes(x=long,
                   y=lat,
                   group=group),
               color="black",
               fill=NA,
               alpha=1,
               linewidth=0.75)+
  coord_fixed(ratio=1.3,
    xlim=c(-125,-65),
              ylim=c(25,50))+
    facet_wrap(~  decade,
               ncol=2)+
  labs(title="Bigfoot Sightings in the Mainland United States, 1869-present",
       subtitle="Using 2° by 2° latitude/longitude grid")+
theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      plot.title=element_text(size=20),
      plot.subtitle=element_text(size=15),
      panel.background=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      strip.text.x=element_text(size=15))+
  scale_fill_gradientn(
    colours=c('#FFFC6B',
                       '#FF9700',
                       '#FF5B00',
                       '#E80000',
                       '#A80000',
                       '#790000'),
    limits=c(1, 100),
    name="Incidence")
```

```{r question-1-figures-2, fig.align="center", warning=FALSE, message=FALSE, fig.show='hold'}
cols_dv <- c("West South Central" = "firebrick1", 
          "East South Central" = "firebrick3",
          "South Atlantic" = "firebrick4",
          "West North Central" = "goldenrod1",
          "East North Central" = "goldenrod3",
          "Middle Atlantic" = "seagreen4",
          "New England" = "seagreen2",
          "Pacific" = "royalblue3",
          "Mountain" = "royalblue1")
cols_rg <- c("South" = "firebrick", 
          "Northeast" = "seagreen",
          "Midwest" = "goldenrod1",
          "West" = "royalblue")
bigfoot <- bigfoot |> filter(!is.na(date))
census <- readr::read_csv('data/CensusDivisions.csv')
census <- census |> rename("state" = "State",
                            "region" = "Region", 
                            "division" = "Division")
bigfoot <- left_join(bigfoot,
                     census, 
                     by="state")
bigfoot_sub <- bigfoot |> 
  select(state, 
         region, 
         division,
         date)
bigfoot_sub <- bigfoot_sub |> 
  mutate(year = as.integer(substring(date,1,4)))
bigfoot_sub <- bigfoot_sub |> 
  mutate(decade = paste(substring(year,1,3),"0s",
                        sep = ""))
bigfoot_sub <- bigfoot_sub |> 
  mutate(decade=ifelse(year<1970,
                       "Pre-1970",
                       decade))
bigfoot_sub <- bigfoot_sub |> 
  mutate(decade=ifelse(year>2009,
                       "Post-2010",
                       decade))
bigfoot_sub <- bigfoot_sub %>% 
  mutate(decade=factor(decade,
                       levels=c("Pre-1970",
                                "1970s",
                                "1980s",
                                "1990s",
                                "2000s",
                                "Post-2010")))
bigfoot_sub_rg <- bigfoot_sub |>
  group_by(region,
           decade)|>
  summarize(num = n())

bigfoot_sub_rg <- bigfoot_sub_rg |> 
  mutate(region=factor(region,
                       levels=c("Northeast",
                                "Midwest",
                                "South",
                                "West")))
ggplot(data = bigfoot_sub_rg,
       mapping = aes(fill=region, 
                     y=num, 
                     x=decade)) + 
    geom_bar(position="fill",
             stat="identity")+
  scale_fill_manual(values = cols_rg,
                          name = "U.S. Census\nRegion")+
  scale_y_continuous(labels = scales::percent)+
  labs(title="Geographic distribution of Bigfoot sightings, 1869-present")+
  xlab("Decade")+
  ylab("Proportion")+
  theme_bw()

bigfoot_sub_dv <- bigfoot_sub |>
  group_by(division,decade)|>
  summarize(num = n())

bigfoot_sub_dv <- bigfoot_sub_dv |> 
  mutate(division=factor(division,
                       levels=c("Middle Atlantic",
                                "New England",
                                "East North Central",
                                "West North Central",
                                "South Atlantic",
                                "East South Central",
                                "West South Central",
                                "Pacific",
                                "Mountain")))

state_mp <- state |> mutate(state=str_to_title(region))
state_mp <- left_join(state_mp, 
                      census,
                      by="state")
state_mp <- state_mp |> 
  mutate(division=factor(division,
                       levels=c("Middle Atlantic",
                                "New England",
                                "East North Central",
                                "West North Central",
                                "South Atlantic",
                                "East South Central",
                                "West South Central",
                                "Pacific",
                                "Mountain")))

state_mp <- state_mp |>
  mutate(region.y=factor(region.y,
                       levels=c("Northeast",
                                "Midwest",
                                "South",
                                "West")))

ggplot()+
  geom_polygon(data=state_mp,
               aes(x=long,
                   y=lat,
                   group=group,
                   fill=region.y),
               color="black",
               alpha=1)+
  scale_fill_manual(values = cols_rg,
                          name = "U.S. Census\nRegion")+
  theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      panel.background=element_rect(fill="white"),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.margin = margin(t = 1, 
                             r = 1, 
                             b = 1, 
                             l = 1))+
      scale_colour_manual(values = cols_rg,
                          name = element_blank())+
  labs(caption="Hawaii and Alaska are in the West region",
       subtitle="Reference")+
  coord_fixed(ratio=1.3,
              xlim=c(-125,-65),
              ylim=c(25,50))


ggplot(data = bigfoot_sub_dv,
       mapping = aes(fill=division, 
                     y=num, 
                     x=decade)) + 
    geom_bar(position="fill", 
             stat="identity")+
  scale_fill_manual(values = cols_dv,
                          name = "U.S. Census\nDivision")+
  scale_y_continuous(labels = scales::percent)+
  labs(title="Geographic distribution of U.S. Bigfoot sightings, 1869-present")+
  xlab("Decade")+
  ylab("Proportion")+
  theme_bw()

ggplot()+
  geom_polygon(data=state_mp,
               aes(x=long,
                   y=lat,
                   group=group,
                   fill=division),
               color="black",
               alpha=1)+
  scale_fill_manual(values = cols_dv,
                          name = "U.S. Census\nDivision")+
  theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      panel.background=element_rect(fill="white"),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.margin = margin(t = 1, 
                             r = 1, 
                             b = 1, 
                             l = 1))+
      scale_colour_manual(values = cols_dv,
                          name = element_blank())+
  labs(caption="Hawaii and Alaska are in the Pacific division",
       subtitle="Reference")+
  coord_fixed(ratio=1.3,
              xlim=c(-125,-65),
              ylim=c(25,50))
```

### Discussion

Notable trends

1.  After 2010, the Midwest has had a lot more relative sightings, and so has the Northeast, according to the barplot. The heatmap shows that Bigfoot is common in Eastern Ohio, and there are now more sightings along the Hudson River Valley (the NY/VT/MA border). Worth noting that Ohio has been popular since the 1970s, but after the 2000s the other regions fell off. The median Bigfoot sighting left Missouri and moved into Southern Illinois for the first time in our data after 2010. Illinois saw no decline in Bigfoot activity that the rest of the nation did on the heatmap.
2.  Bigfoot always concentrated in Washington State - no surprise - but that hotspot seems to have spread out a bit more, lighting up Oregon and Idaho Panhandle in the East.
3.  Eastern Texas up the OK/AR border lit up big time in the 2000s but that trend is almost totally absent in other decades. West South Central division doubled from 1990s to 2000s.
4.  Florida has become a center of Bigfoot activity, especially the swampy southern parts. The Space Coast has the highest density of Bigfoot sightings outside of Northeastern Ohio, Illinois, or Washington.
5.  Bigfoot is spreading his wings! The 2000s brought him/her to the plains (North Dakota, Wyoming, South Dakota, and Nebraska) in greater numbers than ever before. In the 1970s-1980s data you can draw a straight line through the center of the country where Bigfoot never went, but Bigfoot is now regularly spotted in places like the desert of Southwest Texas.
6.  Even though its lush wilderness should have been ideal, New England saw very little Bigfoot sightings until the 1990s. About five percent of post-2010 sightings are from New England, despite it being almost totally absent in 1980/1990 data.
7.  2000s peak around forests south of Lake Tahoe, CA and Yosemite

[***!!!!! NOT COMPLETE !!!!!***]{.underline}

## Question 2: Are certain weather conditions more commonly associated with Bigfoot sightings than others?

### Introduction

(1-2 paragraphs): Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why you're interested in this question.

[***!!!!! NOT COMPLETE !!!!!***]{.underline}

### Approach

(1-2 paragraphs): Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

[***!!! NOT COMPLETE !!!***]{.underline}

### Analysis

(2-3 code blocks, 2 figures, text/code comments as needed): In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides. You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so. All plots must be made with **ggplot2**. Do not use base R or lattice plotting functions.

[***!!! NOT COMPLETE !!!***]{.underline}

### Discussion

(1-3 paragraphs): In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots. Speculate about why the data looks the way it does.

[***!!! NOT COMPLETE !!!***]{.underline}
